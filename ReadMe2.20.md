# MyAI Chat History (ファイル保存版) Ver2.20

## 概要

MyAI Chat Historyは、Google Gemini APIを活用したAIとのチャットを記録・管理するためのWebアプリケーションです。会話内容の要約生成、マークダウンファイル形式での保存、PDFプレビュー・ダウンロード、過去のチャット履歴の閲覧・管理、さらには各種設定（AIの性格、名前、サウンド、音声読み上げなど）を細かくカスタマイズできる機能を提供します。

今回のVer2.20では、**Markdown (MD) ファイルからのチャット履歴インポート機能**が追加され、さらに**「各種設定」画面がタブ形式に整理され、より直感的で使いやすいUIに改善**されました。

## 機能一覧

### 1. AIとのチャット機能

*   **テキスト入力**: `Enter`キーでメッセージを送信し、`Shift + Enter`で改行が可能です。
*   **画像添付**: クリップアイコン (`📎`) をクリックするか、入力欄に画像を直接ペーストすることで、画像ファイルを添付してAIに送信できます。
*   **音声入力**: マイクアイコン (`🎤`) をクリックすることで、音声でメッセージを入力できます（Speech Recognition APIを利用）。
*   **メッセージ操作**:
    *   各メッセージをクリックして選択/解除できます。
    *   選択したメッセージを「**選択を削除**」ボタンで削除できます。
    *   単一選択したメッセージを「**選択を編集**」ボタンで編集できます。
    *   選択したメッセージを「**選択を再生**」ボタンで音声読み上げできます（Text-to-Speech機能）。
    *   音声読み上げ中に「**音声停止**」ボタンで再生を停止できます。

### 2. チャット履歴の管理・保存機能

*   **チャット保存**: 現在のAIとの会話をAIが分析し、簡潔なタイトルと要約を生成してマークダウン（.md）形式でPCにダウンロードします。同時に、アプリ内の履歴リストにも追加されます。
*   **履歴一覧**: ヘッダーの「**履歴一覧**」ボタンから、保存されたチャットのリストを表示します。
    *   タイトルや日付での検索、日付やタイトルでの並べ替え（昇順/降順）が可能です。
    *   リストから選択した履歴を読み込み、チャットボックスに表示できます。
    *   選択した履歴をリストから削除できます（JSONファイルへのエクスポートで永続化）。
*   **新しいチャット**: 現在の会話を破棄して、新しいチャットを開始します（保存していない内容は失われます）。

### 3. ファイルベースでの履歴・設定管理

*   **全履歴をJSONで保存/読込**: 「各種設定」画面の「履歴ファイル管理」タブから、全てのチャット履歴をJSONファイルとして一括でエクスポート/インポートできます。これにより、ブラウザのキャッシュクリアなどによるデータ消失を防ぎ、異なるPC間でのデータ移行も可能です。
*   **MDファイルを読込**: **(Ver2.20で追加)** 「各種設定」画面の「履歴ファイル管理」タブから、過去に「チャット保存」でダウンロードしたマークダウンファイルを読み込み、履歴リストに追加できます。
*   **設定をCSVで保存/読込**: 「各種設定」画面の「アプリ動作設定」タブから、AIの性格や名前、サウンド設定などのアプリケーション設定をCSVファイルとしてエクスポート/インポートできます。

### 4. 各種設定機能 (タブ形式UIに改善)

「**各種設定**」ボタンをクリックすると、以下のタブに分類された設定画面が表示されます。

*   **履歴ファイル管理 (History File Management) - (Ver2.20で追加)**
    *   全チャット履歴のJSONでのエクスポート/インポート
    *   MDファイルからのチャット履歴インポート
*   **AI応答設定 (AI Response Settings) - (Ver2.20で追加)**
    *   **AIの性格（システムプロンプト）**: AIの返答スタイルや役割を定義するプロンプトを設定します。いくつかの設定例も用意されています。
    *   **チャット概要生成プロンプト**: チャット保存時にAIが概要を生成するためのプロ指示を設定します。デフォルトに戻すことも可能です。
    *   **会話履歴の名前設定**: あなたの名前とAIの名前をカスタマイズできます。
*   **アプリ動作設定 (App Behavior Settings) - (Ver2.20で追加)**
    *   **サウンド設定**: AI応答時の通知音のオン/オフ、およびサウンドの種類（サイン波、矩形波など）を設定します。
    *   **AI応答の音声読み上げ (TTS) 設定**: AIの応答を音声で読み上げる機能のオン/オフ、音声の種類、速度、ピッチ、音量を調整できます。
    *   アプリケーション設定のCSVでのエクスポート/インポート

### 5. APIキー設定

*   **Gemini APIキー設定**: ヘッダーの「**API設定**」ボタンから、ご自身のGoogle Gemini APIキーを入力・設定できます。入力したキーの有効性をテストする機能もあります。
*   **キーのクリア**: 設定済みのAPIキーをブラウザから削除できます。

### 6. PDF出力機能

*   **PDFプレビュー**: 現在チャットボックスに表示されている会話内容をPDF形式でプレビュー表示します。
*   **PDFをダウンロード**: プレビュー画面からPDFファイルをPCにダウンロードできます。

### 7. ヘルプ機能

*   **取扱説明書**: ヘッダーの「**取扱説明書**」ボタンをクリックすると、本アプリケーションの機能と使い方が記載されたヘルプ画面が表示されます。

## 必要要件

*   最新のWebブラウザ (Google Chrome, Mozilla Firefox, Microsoft Edgeなど)
*   **Google Gemini APIキー**: APIキーは[Google AI Studio](https://aistudio.google.com/app/apikey)などで取得できます。

## 使い方

1.  `index.html`ファイルをダウンロードし、Webブラウザで開きます。
2.  画面右上の「**API設定**」ボタンをクリックし、ご自身のGemini APIキーを入力して「設定」ボタンで保存します。
    *   **重要**: APIキーはブラウザに保存されますが、セキュリティのため定期的に変更するか、都度入力することをお勧めします。ブラウザのキャッシュをクリアすると削除されます。
3.  「**各種設定**」ボタンから、AIの性格や名前、サウンドなどの設定をカスタマイズできます。
    *   `Ver2.20`ではタブ形式（履歴ファイル管理、AI応答設定、アプリ動作設定）に整理されています。
    *   MDファイルからのインポートは「履歴ファイル管理」タブから行えます。
4.  テキスト入力欄にメッセージを入力し、送信ボタン (`✈️`) をクリックするか`Enter`キーを押してAIとのチャットを開始します。
5.  会話を保存したい場合は、「**チャット保存**」ボタンをクリックすると、AIが要約を生成し、Markdownファイルとしてダウンロードされます。この履歴は「履歴一覧」にも自動的に追加されます。
6.  過去のチャットを閲覧したい場合は、「**履歴一覧**」ボタンをクリックしてリストから選択・読み込みを行います。

## 注意事項

*   APIキー、会話履歴、各種設定は、**ブラウザには自動で永続的に保存されません**。データの保存には、必ず「各種設定」内のエクスポート機能（JSON/CSV）をご利用ください。
*   Google Gemini APIの利用には料金が発生する場合があります。APIキーを発行したご自身のGoogleアカウントの利用状況にご注意ください。
*   Markdownファイルからのインポートでは、画像データ自体は含まれないため、履歴表示時に画像はプレースホルダーとして表示されます。
*   ローカルファイルとして動作するため、Webサーバーは不要です。

---