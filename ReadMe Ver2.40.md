# MyAI Chat History Ver2.40 - ReadMe (取扱説明書)

この度は「MyAI Chat History」をご利用いただき、誠にありがとうございます。
このアプリケーションは、GoogleのGemini APIを利用してAIとの対話を行い、その履歴をファイルとして保存・管理するためのクライアントサイド・アプリケーションです。

## ✨ 主な機能

*   **AIとの対話**: Gemini APIを介した、AIとの自由なテキストおよび画像チャット。
*   **音声入出力**: マイクによる音声入力と、AIの応答を音声で読み上げるTTS（Text-to-Speech）機能。
*   **チャットの保存**: AIが会話内容からタイトルと要約を自動生成し、マークダウン（`.md`）ファイルとして保存。
*   **高度な履歴管理**:
    *   保存したチャットを一覧表示し、過去の対話を簡単に読み込み・検索・並べ替え。
    *   全チャット履歴を単一のJSONファイルとして書き出し（エクスポート）／読み込み（インポート）。
*   **柔軟なカスタマイズ**:
    *   AIの性格（ペルソナ）や応答方法をプロンプトで詳細に設定可能。
    *   会話の要約を生成する際の指示（プロンプト）も自由に編集。
    *   サウンドや読み上げ音声の種類、速さ、ピッチなどを細かく調整。
*   **設定の永続化**: アプリケーションの各種設定をCSVファイルとしてエクスポート／インポート可能。
*   **PDF出力**: 保存したチャット履歴を、印刷や共有に適したPDF形式でプレビュー＆ダウンロード。
*   **メッセージ編集**: 送信したメッセージの内容を後から編集する機能。

## ⚠️【最重要】ご利用前の注意点

### 1. Gemini APIキーが必須です
このアプリケーションの全ての機能を利用するには、ご自身の**Google Gemini APIキー**が必要です。
*   **取得方法**: [Google AI for Developers](https://ai.google.dev/pricing) 等の公式サイトからAPIキーを取得してください。
*   **設定方法**: アプリケーション右上の「**API設定**」ボタンから、取得したAPIキーを入力してください。「APIキーをテスト」ボタンでキーの有効性を確認できます。
*   **料金**: APIの利用料金は、ご自身のGoogleアカウントに準じます。利用量には十分ご注意ください。

### 2. データは自動で保存されません
本アプリケーションは、サーバーを持たないクライアントサイド（ブラウザ完結型）のツールです。チャット履歴や各種設定は、**明示的にファイルとして保存・読み込み操作を行わない限り、ブラウザを閉じると失われます。**

*   **チャット履歴の保存**: 「**各種設定**」→「**履歴ファイル管理**」タブにある「**全履歴をJSONで保存**」を定期的に実行し、データをバックアップしてください。
*   **設定の保存**: 「**各種設定**」→「**アプリ動作設定**」タブの下部にある「**設定をCSVで保存**」で、現在の設定内容をファイルに保存できます。

## 📖 ご利用方法

### Step 1: 初期設定
1.  `index.html`ファイルをブラウザで開きます。
2.  画面右上の「**API設定**」ボタンをクリックします。
3.  ご自身のGemini APIキーを入力し、「**設定**」ボタンを押します。

### Step 2: チャットの開始
*   画面下部のテキストエリアにメッセージを入力し、「✈️」ボタンを押すか、`Enter`キーで送信します。（`Shift + Enter`で改行できます）
*   「📎」ボタンで画像ファイルを添付したり、入力欄に画像を直接ペーストしたりできます。
*   「🎤」ボタンで音声入力が可能です。

### Step 3: チャットの保存
1.  会話が一区切りついたら、ヘッダーの「**チャット保存**」ボタンをクリックします。
2.  AIが会話内容を分析し、タイトルと要約を生成します。
3.  会話の全履歴を含んだマークダウン（`.md`）ファイルが自動的にダウンロードされます。
4.  この操作により、保存したチャットが「履歴一覧」に表示されるようになります。

### Step 4: 履歴の管理とデータの永続化
1.  **履歴の読み込み**: ヘッダーの「**履歴一覧**」ボタンを押し、過去のチャットを選択して「**選択を読込**」をクリックすると、その時点の会話を再現できます。
2.  **【重要】全履歴のバックアップ**:
    *   「**各種設定**」モーダルを開き、「**履歴ファイル管理**」タブに移動します。
    *   「**全履歴をJSONで保存**」ボタンを押し、全てのチャット履歴情報（タイトル、要約、会話データ）を一つのJSONファイルとして保存します。これがあなたのマスターデータとなります。
3.  **【重要】全履歴の復元**:
    *   次回起動時や別のPCで利用する際に、「**各種設定**」→「**履歴ファイル管理**」タブを開きます。
    *   「**全履歴をJSONから読込**」ボタンを押し、以前保存したJSONファイルを選択すると、すべてのチャット履歴が復元されます。

### Step 5: カスタマイズ
1.  ヘッダーの「**各種設定**」ボタンを押します。
2.  **AI応答設定**: AIの性格（ペルソナ）や、要約生成時のプロンプトを自由に変更できます。
3.  **アプリ動作設定**: サウンドのON/OFFや、AI応答の読み上げ（TTS）に関する詳細な設定が可能です。
4.  設定が完了したら、同タブの下部にある「**設定をCSVで保存**」で設定内容をバックアップしておくことをお勧めします。

## 📚 機能詳細ガイド

| ボタン/機能          | 場所                    | 説明                                                                                                                                                                                            |
| -------------------- | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **各種設定**         | ヘッダー                | AIの応答設定、アプリの動作設定、全履歴や設定のインポート／エクスポートを行うための総合設定画面を開きます。                                                                                        |
| **選択を削除/編集/再生** | ヘッダー                | チャットメッセージをクリックして選択状態にすると表示されます。選択したメッセージの削除、編集、音声再生が可能です。                                                                              |
| **チャット保存**     | ヘッダー                | 現在の会話を分析・要約し、`.md`ファイルとしてダウンロードします。同時に履歴リストにも追加されます。                                                                                              |
| **履歴一覧**         | ヘッダー                | 保存されたチャット履歴のリストを表示します。ここから過去のチャットの読み込み、検索、削除（リストからの削除）ができます。                                                                          |
| **PDFプレビュー**      | ヘッダー                | 現在表示しているチャット履歴をPDF形式でプレビューし、ダウンロードできます。（履歴読み込み後に表示されます）                                                                                  |
| **新しいチャット**     | ヘッダー                | 現在の会話を破棄して、新しいセッションを開始します。                                                                                                                                            |
| **API設定**          | ヘッダー                | Gemini APIキーの設定、テスト、クリアを行います。                                                                                                                                                |
| **取扱説明書**       | ヘッダー                | このReadMeファイルと同様のヘルプページを新しいタブで開きます。                                                                                                                                    |
| **全履歴をJSONで保存/読込** | 各種設定モーダル        | **（推奨バックアップ方法）** 全てのチャット履歴のメタデータ（タイトル、要約、会話内容）を単一の`.json`ファイルで保存・復元します。                                                               |
| **MDファイルを読込**   | 各種設定モーダル        | 「チャット保存」機能で作成した`.md`ファイルを個別に読み込み、履歴一覧に追加します。                                                                                                                |
| **設定をCSVで保存/読込** | 各種設定モーダル        | AIのペルソナやTTS設定など、アプリケーションの全ての動作設定を`.csv`ファイルで保存・復元します。                                                                                                 |

## 🔧 技術情報

*   **API**: Google Gemini API (`gemini-2.0-flash`)
*   **ライブラリ**: html2pdf.js (PDF生成用)
*   **データストレージ**: ユーザーによるファイル保存（JSON, CSV, MD）。設定の一部は `localStorage` に一時保存されます。

---
*MyAI Chat History Ver2.40*